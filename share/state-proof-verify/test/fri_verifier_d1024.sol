// SPDX-License-Identifier: MIT OR Apache-2.0
//---------------------------------------------------------------------------//
// Copyright (c) 2021 Mikhail Komarov <nemo@nil.foundation>
// Copyright (c) 2021 Ilias Khairullin <ilias@nil.foundation>
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//    http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//---------------------------------------------------------------------------//

pragma solidity >=0.8.4;
pragma experimental ABIEncoderV2;

import "truffle/Assert.sol";
import '../contracts/types.sol';
import '../contracts/commitments/fri_verifier.sol';
import '../contracts/cryptography/transcript.sol';

// TODO: add false-positive tests
contract TestFRIVerifier_d1024 {
    function test_fri_proof_verification_d1024() public {
        // bn254 scalar field
        uint256 modulus = 21888242871839275222246405745257275088548364400416034343698204186575808495617;
        bytes memory raw_proof = hex"0000000000000001044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a000000000000000a17f7104cb0760a6bad85b86f8be84dbc233bd3234fde5aebbcf7b0f23cbb12550000000000000020aa8572edb43e22e3253c748a58d12ba6b348e46400c8e827b57dba1d6b483c260000000000000002060140891cbee3387ede5d29b388b38dd59f13be3533c4668b476f14c126772e089a5bf40657689be9fbf3049c758c64b37bde584644d20e3f2fffc1a18dc37100000000000001910000000000000020b974999fec1b97fc83adb9a9ab99c948e7d24aed2edd43880dce306cd966e72f0000000000000009000000000000000100000000000000000000000000000020d87670d4a29e51168b2be09846997b01c1864a06a79569a4f51bd225cf0e1a2f000000000000000100000000000000010000000000000020b40a8f6a9dfeb82ed212964dca3abe252d8783fc8f99b6c8e7bae87e30c79e31000000000000000100000000000000010000000000000020e7cde5d9e73ea6b6629478ca984459100b576905e90cf805f8bd8135865b2f0400000000000000010000000000000001000000000000002058de4ab5411044fc18f96b0f8d1dcec8a5ba070bde38bbf39743269216b759d800000000000000010000000000000000000000000000002058fe956c4a8e391d6711837cce5395b22453f7e126043bd253d92e7d4f31d627000000000000000100000000000000010000000000000020aad61d7aaa5f733bbd670c029c60421dd147ac463dc149810ebb135b9144882800000000000000010000000000000001000000000000002026909d0b82925a1aedad195d8b000fd163ffd6a769c002837aeb142bc98de36400000000000000010000000000000000000000000000002096d5e0cf7588d3a22adb2b97b72408f2a8270ba85651077f00442ea9e1a46077000000000000000100000000000000000000000000000020e531df6023e7f701afed9ea2d0dbe9dc15840c558f9082547337b9be2dd5138e000000000000000200000000000001910000000000000020aa8572edb43e22e3253c748a58d12ba6b348e46400c8e827b57dba1d6b483c26000000000000000a00000000000000010000000000000000000000000000002090b2afa751534126d7ad9b8c3dd9b4919e02b426bf4c9cc6f964c6be07fdad5b000000000000000100000000000000010000000000000020192a706d4320e2dcb0275f6333e102708755c1921c31b45234bf876cd3157dbb0000000000000001000000000000000100000000000000209c0b364667c6b57ffb1a1e83cbba58666fc90050e5eeb518911d08f14b57fb8f000000000000000100000000000000010000000000000020839f29198d108cb08443650423ab725e4198bf6441bdc7fd188d76bc8b1a90b30000000000000001000000000000000000000000000000200718d47a099a6265d497db9bb67543f27ae270082066879ef0e289d6b15aa900000000000000000100000000000000010000000000000020b34008c06c74b4aae619f7ccae49b649b7524c89a3addac61d203676ce8c68af00000000000000010000000000000001000000000000002097786766a754013ae358f00d482b7271cd6fac9545014b30c1d3fb30a55355d00000000000000001000000000000000000000000000000209988ab2541b78e38d14fbd319fc6f1631fbf9d1cc05d45607c25293d09cd3a3a0000000000000001000000000000000000000000000000208ce312548306c258a417552a79e14ecb8d5960332b50ca2c62e8f3e4b38ff5d70000000000000001000000000000000100000000000000200af44cd4b59b96d696cab7be2675f0b4437235d4a0b8a4d6522b8bf054a1e42d00000000000003910000000000000020aa8572edb43e22e3253c748a58d12ba6b348e46400c8e827b57dba1d6b483c26000000000000000a0000000000000001000000000000000000000000000000208d4a34cc9f1b55c0b16be4e80ab070f79a3ceaa084a9c4b833c66e4cff3e309e0000000000000001000000000000000100000000000000200be61f990c5bd9fedd368015e05020911d4720f17a2d72ffe8958c159545200200000000000000010000000000000001000000000000002014b019b87d8c71ae34beb3304c3d48d8441c7f91e8c8ba1e055d2f055e091e4c0000000000000001000000000000000100000000000000202afb20e98702fce1948db0df03005d550e55253e4a65d7102efd2b1e9e366aec0000000000000001000000000000000000000000000000202853e060b812991a9ba691229ad73c251796e67fc9b6827e27ae86654529bcae0000000000000001000000000000000100000000000000209224400f6c4af13d5ab0af5fc8a1a8ee079e8e55ba945ecc52a7718d2738b1c6000000000000000100000000000000010000000000000020c1aad3722466b6293773f17f40d4acd88f70471a70c876e160107afd4d8795f40000000000000001000000000000000000000000000000207f4a81133a319f158868a1d91eebf4d3a1f7babe760ed92a3af2e934e8eef1e1000000000000000100000000000000000000000000000020f002da91f005de338b77dd157d420a846d25d65186bcb4340fe58550a641db98000000000000000100000000000000000000000000000020b915e00a3f422c7ef6dbd1bd63a6f4783cbcb773f25e82ca2eb00ab4836a700b2f8f09e42c2b1943ece8e16c2cb84bf2688481594dd8cc52d6d387690d8b7bac0000000000000020b974999fec1b97fc83adb9a9ab99c948e7d24aed2edd43880dce306cd966e72f000000000000000217f7104cb0760a6bad85b86f8be84dbc233bd3234fde5aebbcf7b0f23cbb125522141d50d58865db825871a4b6f368acd47dfb258c34a046ac82d891543bfdfc000000000000009100000000000000209454edf4f0fdc13210d67758ffd598f11c2b0a3595ff4c1d7da9ca33bb7932870000000000000008000000000000000100000000000000000000000000000020277b71778632b97ef55098d91a51f646a7d17ed8e21f8dc97208d2bb2a7dda1200000000000000010000000000000001000000000000002007af861825c8836bb699248e099225ea806fe633df593ab60c6235d490efc7a00000000000000001000000000000000100000000000000207ea7b58c8bf54a65f5d23f92d1dd0b96a4d170cb7493bab67bc6f91aef773ec6000000000000000100000000000000010000000000000020fbf8581ba9ea0b3bf5d8b537e29bc4027bbebe32cab85ee6b5b480999765a988000000000000000100000000000000000000000000000020064ba699f8d41bd2657c0773c89128215a9268b5faa935c6cfcc94128cbff7660000000000000001000000000000000100000000000000205222f6f6e191ef047b4126d32708ea6a85699da6a9ab543355484c4be8532043000000000000000100000000000000010000000000000020d8b7b8d99a8463b16b1c1311d5d9cee8e546b25f4a03f2a29e45ce28e55ea13400000000000000010000000000000000000000000000002043898f529d46b3b4e484dcd82a7bd7de9362082425035f19ff747fb13679c0a4000000000000000200000000000001910000000000000020b974999fec1b97fc83adb9a9ab99c948e7d24aed2edd43880dce306cd966e72f0000000000000009000000000000000100000000000000000000000000000020d87670d4a29e51168b2be09846997b01c1864a06a79569a4f51bd225cf0e1a2f000000000000000100000000000000010000000000000020b40a8f6a9dfeb82ed212964dca3abe252d8783fc8f99b6c8e7bae87e30c79e31000000000000000100000000000000010000000000000020e7cde5d9e73ea6b6629478ca984459100b576905e90cf805f8bd8135865b2f0400000000000000010000000000000001000000000000002058de4ab5411044fc18f96b0f8d1dcec8a5ba070bde38bbf39743269216b759d800000000000000010000000000000000000000000000002058fe956c4a8e391d6711837cce5395b22453f7e126043bd253d92e7d4f31d627000000000000000100000000000000010000000000000020aad61d7aaa5f733bbd670c029c60421dd147ac463dc149810ebb135b9144882800000000000000010000000000000001000000000000002026909d0b82925a1aedad195d8b000fd163ffd6a769c002837aeb142bc98de36400000000000000010000000000000000000000000000002096d5e0cf7588d3a22adb2b97b72408f2a8270ba85651077f00442ea9e1a46077000000000000000100000000000000000000000000000020e531df6023e7f701afed9ea2d0dbe9dc15840c558f9082547337b9be2dd5138e00000000000000910000000000000020b974999fec1b97fc83adb9a9ab99c948e7d24aed2edd43880dce306cd966e72f0000000000000009000000000000000100000000000000000000000000000020b7e64f97f8be4f77eb3da06768a765993f4c4ff48e06d618c7510b49f810bea30000000000000001000000000000000100000000000000206627048a678b0eaa613ae8022bb034beff375a8cf3acfc6bbd6c0790ba6afdea000000000000000100000000000000010000000000000020acf9935a088e336bbb5f7e4faf99bdf23f541cdca42da372880b5a6eccf45f5b000000000000000100000000000000010000000000000020791495454d18ac121d533de58c586bb631f641c4c03ba3fb05a19de7c0193754000000000000000100000000000000000000000000000020c30d2eb9b4b9224eb2e6e216a6b1c222e736092fe7cd66f3f3702f5e94cf319d0000000000000001000000000000000100000000000000202520aa88a9c0d5dd5c513d4969b1bffc6d3aed5ce97c8e25cb15376ba8047dcc000000000000000100000000000000010000000000000020279ec92e19de56a3d894e93915afcb87921b8e88c9f84b3f3d2f56109cf6cfad00000000000000010000000000000000000000000000002080566a8870bf15a150e07c2590c223c8e254fca7ae4050f37e2743dc3696868c000000000000000100000000000000010000000000000020ebf1a87733dedb910590682d9edf689363b2b9b1cfedfdacd9ff099d46e9429213cae950f48ebbb0040c22f7121220d51d9ae002dfb332a2525b30b2cba519eb00000000000000209454edf4f0fdc13210d67758ffd598f11c2b0a3595ff4c1d7da9ca33bb79328700000000000000022f8f09e42c2b1943ece8e16c2cb84bf2688481594dd8cc52d6d387690d8b7bac16a904adcc75f724063e3f715284d7e822594aa4e6ab61a7c5364ac239521fc900000000000000110000000000000020a5f0e248af2e8d83373f8dbe2a263fa2fa61c70760be2cb1d672b6c528eef195000000000000000700000000000000010000000000000000000000000000002048e1d0e6eea4f80ba2bd07b1cd16288e1fa5d3ed2877cc0a4c87a8287b0d4cb50000000000000001000000000000000100000000000000208326e9589c61ad7bea45e4801619846e8520d95de62c029ba44c340884e7a583000000000000000100000000000000010000000000000020efb7d3b693f63614e03dbb15057ee6f06a38b0b9fac359119622a1693a09e4d50000000000000001000000000000000100000000000000202455bc821318a73283adbc358d9b93ebeed4a2c3b77e86d15732d576a86f3483000000000000000100000000000000000000000000000020e355329ef752e1191251984af003de746d7cb874a72410056ef34e561e9ae2ac000000000000000100000000000000010000000000000020b6d4f44eac1e7104c022e09c07f315b53db4ae385d1671b4d59762cf659a39ff0000000000000001000000000000000100000000000000208df11b3af5acddafd4debd2a6da157c4237557b132e705ca5f62a818c38b208a0000000000000002000000000000009100000000000000209454edf4f0fdc13210d67758ffd598f11c2b0a3595ff4c1d7da9ca33bb7932870000000000000008000000000000000100000000000000000000000000000020277b71778632b97ef55098d91a51f646a7d17ed8e21f8dc97208d2bb2a7dda1200000000000000010000000000000001000000000000002007af861825c8836bb699248e099225ea806fe633df593ab60c6235d490efc7a00000000000000001000000000000000100000000000000207ea7b58c8bf54a65f5d23f92d1dd0b96a4d170cb7493bab67bc6f91aef773ec6000000000000000100000000000000010000000000000020fbf8581ba9ea0b3bf5d8b537e29bc4027bbebe32cab85ee6b5b480999765a988000000000000000100000000000000000000000000000020064ba699f8d41bd2657c0773c89128215a9268b5faa935c6cfcc94128cbff7660000000000000001000000000000000100000000000000205222f6f6e191ef047b4126d32708ea6a85699da6a9ab543355484c4be8532043000000000000000100000000000000010000000000000020d8b7b8d99a8463b16b1c1311d5d9cee8e546b25f4a03f2a29e45ce28e55ea13400000000000000010000000000000000000000000000002043898f529d46b3b4e484dcd82a7bd7de9362082425035f19ff747fb13679c0a4000000000000001100000000000000209454edf4f0fdc13210d67758ffd598f11c2b0a3595ff4c1d7da9ca33bb793287000000000000000800000000000000010000000000000000000000000000002043834b0a06d8b266b26be0854b7a79aa971fbef6ddaa80d8b15f1d8943be68c3000000000000000100000000000000010000000000000020f537a6c816605dab7bdf134249a90622b8b4bc0c39809a05575022aa320e6cd900000000000000010000000000000001000000000000002057effbdf6394e0e074df2efeed774d8c831cb1e12a71f79488d452e2f8c29c1400000000000000010000000000000001000000000000002057a730b1249f97fba51acf8c053f7e6deb146d184851b09023ca539f8fd29ea700000000000000010000000000000000000000000000002007ffab422926dd9c5664db8eca2d4f70af28f0536021588b5993707bccee3daf000000000000000100000000000000010000000000000020110a572828b30b0cd6bbd6089be622f9cfde25a3974ddc6dafab153e92d3503000000000000000010000000000000001000000000000002065b6090624c4ccffc550ffbff1c17a92472e4d70f12e988a3888c4fe8873b95300000000000000010000000000000001000000000000002048836e7b74e8f7cbe3c02016c5682b4ae2891bd5feec509cb48d7ecfc25aa3b3044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a0000000000000020a5f0e248af2e8d83373f8dbe2a263fa2fa61c70760be2cb1d672b6c528eef195000000000000000213cae950f48ebbb0040c22f7121220d51d9ae002dfb332a2525b30b2cba519eb2b3c87d79ea7a6936915db1be25bcf745f66a348733a55a7bdb2d1896ed0740f000000000000000000000000000000207be9e8276a6593be6d504ea70e98b059195254948d2d34fdf740cb205efc816600000000000000060000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d0000000000000001000000000000000100000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe40000000000000000100000000000000010000000000000020188fcbd1c886a6fe1df08203d074439a0ab7295075c39584f39a57cac59c7a4e000000000000000100000000000000010000000000000020ad83bce065c17d88d5ac7ffe06ada4516ab75113588c7f0755662895ac3db280000000000000000200000000000000110000000000000020a5f0e248af2e8d83373f8dbe2a263fa2fa61c70760be2cb1d672b6c528eef195000000000000000700000000000000010000000000000000000000000000002048e1d0e6eea4f80ba2bd07b1cd16288e1fa5d3ed2877cc0a4c87a8287b0d4cb50000000000000001000000000000000100000000000000208326e9589c61ad7bea45e4801619846e8520d95de62c029ba44c340884e7a583000000000000000100000000000000010000000000000020efb7d3b693f63614e03dbb15057ee6f06a38b0b9fac359119622a1693a09e4d50000000000000001000000000000000100000000000000202455bc821318a73283adbc358d9b93ebeed4a2c3b77e86d15732d576a86f3483000000000000000100000000000000000000000000000020e355329ef752e1191251984af003de746d7cb874a72410056ef34e561e9ae2ac000000000000000100000000000000010000000000000020b6d4f44eac1e7104c022e09c07f315b53db4ae385d1671b4d59762cf659a39ff0000000000000001000000000000000100000000000000208df11b3af5acddafd4debd2a6da157c4237557b132e705ca5f62a818c38b208a00000000000000510000000000000020a5f0e248af2e8d83373f8dbe2a263fa2fa61c70760be2cb1d672b6c528eef195000000000000000700000000000000010000000000000000000000000000002064074aaf2d18a4b6a7062d2deaeb6de0c7611a2898be13cb6eb02cf14939f415000000000000000100000000000000010000000000000020601b4d247cd9878455132cbe88dc63681d0895224581994debbeb36fdb6ecf220000000000000001000000000000000100000000000000205c4f258dd1ea8e37f008f2cc55ea6f9ea8393a7975861dc1f0099fafb85fd89a000000000000000100000000000000010000000000000020887965eb6803e90b9e2ebf06b424f0151498e7c3f32bd7bfbcd38aaffbf2157000000000000000010000000000000000000000000000002098ca15184b38ee441cebcb57343616fb16f556ab15ad9837706d34e332834b05000000000000000100000000000000010000000000000020158eed45536428a1c5b4f55c36719733ea2b479362f13570d96e7223fb751ddf000000000000000100000000000000000000000000000020c3799a6d73a98eef7793ff51af82bb5348709f82b423768dd000eace2d6a8f43044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a00000000000000207be9e8276a6593be6d504ea70e98b059195254948d2d34fdf740cb205efc81660000000000000002044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a00000000000000000000000000000020ad83bce065c17d88d5ac7ffe06ada4516ab75113588c7f0755662895ac3db28000000000000000050000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d0000000000000001000000000000000100000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe40000000000000000100000000000000010000000000000020188fcbd1c886a6fe1df08203d074439a0ab7295075c39584f39a57cac59c7a4e0000000000000002000000000000000000000000000000207be9e8276a6593be6d504ea70e98b059195254948d2d34fdf740cb205efc816600000000000000060000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d0000000000000001000000000000000100000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe40000000000000000100000000000000010000000000000020188fcbd1c886a6fe1df08203d074439a0ab7295075c39584f39a57cac59c7a4e000000000000000100000000000000010000000000000020ad83bce065c17d88d5ac7ffe06ada4516ab75113588c7f0755662895ac3db280000000000000000000000000000000207be9e8276a6593be6d504ea70e98b059195254948d2d34fdf740cb205efc816600000000000000060000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d0000000000000001000000000000000100000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe40000000000000000100000000000000010000000000000020188fcbd1c886a6fe1df08203d074439a0ab7295075c39584f39a57cac59c7a4e000000000000000100000000000000010000000000000020ad83bce065c17d88d5ac7ffe06ada4516ab75113588c7f0755662895ac3db280044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a0000000000000020ad83bce065c17d88d5ac7ffe06ada4516ab75113588c7f0755662895ac3db2800000000000000002044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a00000000000000000000000000000020188fcbd1c886a6fe1df08203d074439a0ab7295075c39584f39a57cac59c7a4e00000000000000040000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d0000000000000001000000000000000100000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe40000000000000000200000000000000000000000000000020ad83bce065c17d88d5ac7ffe06ada4516ab75113588c7f0755662895ac3db28000000000000000050000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d0000000000000001000000000000000100000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe40000000000000000100000000000000010000000000000020188fcbd1c886a6fe1df08203d074439a0ab7295075c39584f39a57cac59c7a4e00000000000000000000000000000020ad83bce065c17d88d5ac7ffe06ada4516ab75113588c7f0755662895ac3db28000000000000000050000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d0000000000000001000000000000000100000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe40000000000000000100000000000000010000000000000020188fcbd1c886a6fe1df08203d074439a0ab7295075c39584f39a57cac59c7a4e044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a0000000000000020188fcbd1c886a6fe1df08203d074439a0ab7295075c39584f39a57cac59c7a4e0000000000000002044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a000000000000000000000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe4000000000000000030000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d000000000000000200000000000000000000000000000020188fcbd1c886a6fe1df08203d074439a0ab7295075c39584f39a57cac59c7a4e00000000000000040000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d0000000000000001000000000000000100000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe4000000000000000000000000000000020188fcbd1c886a6fe1df08203d074439a0ab7295075c39584f39a57cac59c7a4e00000000000000040000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d0000000000000001000000000000000100000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe40044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a00000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe400000000000000002044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a00000000000000000000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d00000000000000020000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b7770000000000000002000000000000000000000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe4000000000000000030000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d000000000000000000000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe4000000000000000030000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a0000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d0000000000000002044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a000000000000000000000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b77700000000000000010000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed000000000000000200000000000000000000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d00000000000000020000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b77700000000000000000000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d00000000000000020000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a00000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b7770000000000000002044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a00000000000000000000000000000020e08d2e78fe7f0000d93a5b0000000000eda00c13d58f80b4f8ffffffffffffff00000000000000000000000000000002000000000000000000000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b77700000000000000010000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed000000000000000000000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b77700000000000000010000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed";
        bytes memory init_blob = hex"00010203040506070809";
        types.transcript_data memory tr_state;
        transcript.init_transcript(tr_state, init_blob);
        types.fri_params_type memory params;
        params.modulus = modulus;
        params.r = 10;
        params.max_degree = 1023;
        uint256[] memory D_omegas = new uint256[](params.r);
        D_omegas[0] = 3161067157621608152362653341354432744960400845131437947728257924963983317266;
        D_omegas[1] = 6837567842312086091520287814181175430087169027974246751610506942214842701774;
        D_omegas[2] = 3478517300119284901893091970156912948790432420133812234316178878452092729974;
        D_omegas[3] = 10359452186428527605436343203440067497552205259388878191021578220384701716497;
        D_omegas[4] = 9088801421649573101014283686030284801466796108869023335878462724291607593530;
        D_omegas[5] = 4419234939496763621076330863786513495701855246241724391626358375488475697872;
        D_omegas[6] = 14940766826517323942636479241147756311199852622225275649687664389641784935947;
        D_omegas[7] = 19540430494807482326159819597004422086093766032135589407132600596362845576832;
        D_omegas[8] = 21888242871839275217838484774961031246007050428528088939761107053157389710902;
        D_omegas[9] = 21888242871839275222246405745257275088548364400416034343698204186575808495616;
        params.D_omegas = D_omegas;
        uint256[] memory q = new uint256[](3);
        q[0] = 0;
        q[1] = 0;
        q[2] = 1;
        params.q = q;
        uint256[] memory U = new uint256[](1);
        U[0] = 0;
        uint256[] memory V = new uint256[](1);
        V[0] = 1;
        params.U = U;
        params.V = V;
        (types.fri_proof_type memory proof, uint256 proof_size) = fri_verifier.parse_proof_be(raw_proof, 0);
        Assert.equal(raw_proof.length, proof_size, "Proof length is not correct");
        Assert.equal(raw_proof.length, fri_verifier.skip_proof_be(raw_proof, 0), "Skipping proof is not correct");
        bool result = fri_verifier.verifyProof(proof, tr_state, params);
        Assert.equal(true, result, "Proof is not correct");
    }

    function test_fri_proof_raw_verification_d1024() public {
        // bn254 scalar field
        uint256 modulus = 21888242871839275222246405745257275088548364400416034343698204186575808495617;
        bytes memory raw_proof = hex"0000000000000001044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a000000000000000a17f7104cb0760a6bad85b86f8be84dbc233bd3234fde5aebbcf7b0f23cbb12550000000000000020aa8572edb43e22e3253c748a58d12ba6b348e46400c8e827b57dba1d6b483c260000000000000002060140891cbee3387ede5d29b388b38dd59f13be3533c4668b476f14c126772e089a5bf40657689be9fbf3049c758c64b37bde584644d20e3f2fffc1a18dc37100000000000001910000000000000020b974999fec1b97fc83adb9a9ab99c948e7d24aed2edd43880dce306cd966e72f0000000000000009000000000000000100000000000000000000000000000020d87670d4a29e51168b2be09846997b01c1864a06a79569a4f51bd225cf0e1a2f000000000000000100000000000000010000000000000020b40a8f6a9dfeb82ed212964dca3abe252d8783fc8f99b6c8e7bae87e30c79e31000000000000000100000000000000010000000000000020e7cde5d9e73ea6b6629478ca984459100b576905e90cf805f8bd8135865b2f0400000000000000010000000000000001000000000000002058de4ab5411044fc18f96b0f8d1dcec8a5ba070bde38bbf39743269216b759d800000000000000010000000000000000000000000000002058fe956c4a8e391d6711837cce5395b22453f7e126043bd253d92e7d4f31d627000000000000000100000000000000010000000000000020aad61d7aaa5f733bbd670c029c60421dd147ac463dc149810ebb135b9144882800000000000000010000000000000001000000000000002026909d0b82925a1aedad195d8b000fd163ffd6a769c002837aeb142bc98de36400000000000000010000000000000000000000000000002096d5e0cf7588d3a22adb2b97b72408f2a8270ba85651077f00442ea9e1a46077000000000000000100000000000000000000000000000020e531df6023e7f701afed9ea2d0dbe9dc15840c558f9082547337b9be2dd5138e000000000000000200000000000001910000000000000020aa8572edb43e22e3253c748a58d12ba6b348e46400c8e827b57dba1d6b483c26000000000000000a00000000000000010000000000000000000000000000002090b2afa751534126d7ad9b8c3dd9b4919e02b426bf4c9cc6f964c6be07fdad5b000000000000000100000000000000010000000000000020192a706d4320e2dcb0275f6333e102708755c1921c31b45234bf876cd3157dbb0000000000000001000000000000000100000000000000209c0b364667c6b57ffb1a1e83cbba58666fc90050e5eeb518911d08f14b57fb8f000000000000000100000000000000010000000000000020839f29198d108cb08443650423ab725e4198bf6441bdc7fd188d76bc8b1a90b30000000000000001000000000000000000000000000000200718d47a099a6265d497db9bb67543f27ae270082066879ef0e289d6b15aa900000000000000000100000000000000010000000000000020b34008c06c74b4aae619f7ccae49b649b7524c89a3addac61d203676ce8c68af00000000000000010000000000000001000000000000002097786766a754013ae358f00d482b7271cd6fac9545014b30c1d3fb30a55355d00000000000000001000000000000000000000000000000209988ab2541b78e38d14fbd319fc6f1631fbf9d1cc05d45607c25293d09cd3a3a0000000000000001000000000000000000000000000000208ce312548306c258a417552a79e14ecb8d5960332b50ca2c62e8f3e4b38ff5d70000000000000001000000000000000100000000000000200af44cd4b59b96d696cab7be2675f0b4437235d4a0b8a4d6522b8bf054a1e42d00000000000003910000000000000020aa8572edb43e22e3253c748a58d12ba6b348e46400c8e827b57dba1d6b483c26000000000000000a0000000000000001000000000000000000000000000000208d4a34cc9f1b55c0b16be4e80ab070f79a3ceaa084a9c4b833c66e4cff3e309e0000000000000001000000000000000100000000000000200be61f990c5bd9fedd368015e05020911d4720f17a2d72ffe8958c159545200200000000000000010000000000000001000000000000002014b019b87d8c71ae34beb3304c3d48d8441c7f91e8c8ba1e055d2f055e091e4c0000000000000001000000000000000100000000000000202afb20e98702fce1948db0df03005d550e55253e4a65d7102efd2b1e9e366aec0000000000000001000000000000000000000000000000202853e060b812991a9ba691229ad73c251796e67fc9b6827e27ae86654529bcae0000000000000001000000000000000100000000000000209224400f6c4af13d5ab0af5fc8a1a8ee079e8e55ba945ecc52a7718d2738b1c6000000000000000100000000000000010000000000000020c1aad3722466b6293773f17f40d4acd88f70471a70c876e160107afd4d8795f40000000000000001000000000000000000000000000000207f4a81133a319f158868a1d91eebf4d3a1f7babe760ed92a3af2e934e8eef1e1000000000000000100000000000000000000000000000020f002da91f005de338b77dd157d420a846d25d65186bcb4340fe58550a641db98000000000000000100000000000000000000000000000020b915e00a3f422c7ef6dbd1bd63a6f4783cbcb773f25e82ca2eb00ab4836a700b2f8f09e42c2b1943ece8e16c2cb84bf2688481594dd8cc52d6d387690d8b7bac0000000000000020b974999fec1b97fc83adb9a9ab99c948e7d24aed2edd43880dce306cd966e72f000000000000000217f7104cb0760a6bad85b86f8be84dbc233bd3234fde5aebbcf7b0f23cbb125522141d50d58865db825871a4b6f368acd47dfb258c34a046ac82d891543bfdfc000000000000009100000000000000209454edf4f0fdc13210d67758ffd598f11c2b0a3595ff4c1d7da9ca33bb7932870000000000000008000000000000000100000000000000000000000000000020277b71778632b97ef55098d91a51f646a7d17ed8e21f8dc97208d2bb2a7dda1200000000000000010000000000000001000000000000002007af861825c8836bb699248e099225ea806fe633df593ab60c6235d490efc7a00000000000000001000000000000000100000000000000207ea7b58c8bf54a65f5d23f92d1dd0b96a4d170cb7493bab67bc6f91aef773ec6000000000000000100000000000000010000000000000020fbf8581ba9ea0b3bf5d8b537e29bc4027bbebe32cab85ee6b5b480999765a988000000000000000100000000000000000000000000000020064ba699f8d41bd2657c0773c89128215a9268b5faa935c6cfcc94128cbff7660000000000000001000000000000000100000000000000205222f6f6e191ef047b4126d32708ea6a85699da6a9ab543355484c4be8532043000000000000000100000000000000010000000000000020d8b7b8d99a8463b16b1c1311d5d9cee8e546b25f4a03f2a29e45ce28e55ea13400000000000000010000000000000000000000000000002043898f529d46b3b4e484dcd82a7bd7de9362082425035f19ff747fb13679c0a4000000000000000200000000000001910000000000000020b974999fec1b97fc83adb9a9ab99c948e7d24aed2edd43880dce306cd966e72f0000000000000009000000000000000100000000000000000000000000000020d87670d4a29e51168b2be09846997b01c1864a06a79569a4f51bd225cf0e1a2f000000000000000100000000000000010000000000000020b40a8f6a9dfeb82ed212964dca3abe252d8783fc8f99b6c8e7bae87e30c79e31000000000000000100000000000000010000000000000020e7cde5d9e73ea6b6629478ca984459100b576905e90cf805f8bd8135865b2f0400000000000000010000000000000001000000000000002058de4ab5411044fc18f96b0f8d1dcec8a5ba070bde38bbf39743269216b759d800000000000000010000000000000000000000000000002058fe956c4a8e391d6711837cce5395b22453f7e126043bd253d92e7d4f31d627000000000000000100000000000000010000000000000020aad61d7aaa5f733bbd670c029c60421dd147ac463dc149810ebb135b9144882800000000000000010000000000000001000000000000002026909d0b82925a1aedad195d8b000fd163ffd6a769c002837aeb142bc98de36400000000000000010000000000000000000000000000002096d5e0cf7588d3a22adb2b97b72408f2a8270ba85651077f00442ea9e1a46077000000000000000100000000000000000000000000000020e531df6023e7f701afed9ea2d0dbe9dc15840c558f9082547337b9be2dd5138e00000000000000910000000000000020b974999fec1b97fc83adb9a9ab99c948e7d24aed2edd43880dce306cd966e72f0000000000000009000000000000000100000000000000000000000000000020b7e64f97f8be4f77eb3da06768a765993f4c4ff48e06d618c7510b49f810bea30000000000000001000000000000000100000000000000206627048a678b0eaa613ae8022bb034beff375a8cf3acfc6bbd6c0790ba6afdea000000000000000100000000000000010000000000000020acf9935a088e336bbb5f7e4faf99bdf23f541cdca42da372880b5a6eccf45f5b000000000000000100000000000000010000000000000020791495454d18ac121d533de58c586bb631f641c4c03ba3fb05a19de7c0193754000000000000000100000000000000000000000000000020c30d2eb9b4b9224eb2e6e216a6b1c222e736092fe7cd66f3f3702f5e94cf319d0000000000000001000000000000000100000000000000202520aa88a9c0d5dd5c513d4969b1bffc6d3aed5ce97c8e25cb15376ba8047dcc000000000000000100000000000000010000000000000020279ec92e19de56a3d894e93915afcb87921b8e88c9f84b3f3d2f56109cf6cfad00000000000000010000000000000000000000000000002080566a8870bf15a150e07c2590c223c8e254fca7ae4050f37e2743dc3696868c000000000000000100000000000000010000000000000020ebf1a87733dedb910590682d9edf689363b2b9b1cfedfdacd9ff099d46e9429213cae950f48ebbb0040c22f7121220d51d9ae002dfb332a2525b30b2cba519eb00000000000000209454edf4f0fdc13210d67758ffd598f11c2b0a3595ff4c1d7da9ca33bb79328700000000000000022f8f09e42c2b1943ece8e16c2cb84bf2688481594dd8cc52d6d387690d8b7bac16a904adcc75f724063e3f715284d7e822594aa4e6ab61a7c5364ac239521fc900000000000000110000000000000020a5f0e248af2e8d83373f8dbe2a263fa2fa61c70760be2cb1d672b6c528eef195000000000000000700000000000000010000000000000000000000000000002048e1d0e6eea4f80ba2bd07b1cd16288e1fa5d3ed2877cc0a4c87a8287b0d4cb50000000000000001000000000000000100000000000000208326e9589c61ad7bea45e4801619846e8520d95de62c029ba44c340884e7a583000000000000000100000000000000010000000000000020efb7d3b693f63614e03dbb15057ee6f06a38b0b9fac359119622a1693a09e4d50000000000000001000000000000000100000000000000202455bc821318a73283adbc358d9b93ebeed4a2c3b77e86d15732d576a86f3483000000000000000100000000000000000000000000000020e355329ef752e1191251984af003de746d7cb874a72410056ef34e561e9ae2ac000000000000000100000000000000010000000000000020b6d4f44eac1e7104c022e09c07f315b53db4ae385d1671b4d59762cf659a39ff0000000000000001000000000000000100000000000000208df11b3af5acddafd4debd2a6da157c4237557b132e705ca5f62a818c38b208a0000000000000002000000000000009100000000000000209454edf4f0fdc13210d67758ffd598f11c2b0a3595ff4c1d7da9ca33bb7932870000000000000008000000000000000100000000000000000000000000000020277b71778632b97ef55098d91a51f646a7d17ed8e21f8dc97208d2bb2a7dda1200000000000000010000000000000001000000000000002007af861825c8836bb699248e099225ea806fe633df593ab60c6235d490efc7a00000000000000001000000000000000100000000000000207ea7b58c8bf54a65f5d23f92d1dd0b96a4d170cb7493bab67bc6f91aef773ec6000000000000000100000000000000010000000000000020fbf8581ba9ea0b3bf5d8b537e29bc4027bbebe32cab85ee6b5b480999765a988000000000000000100000000000000000000000000000020064ba699f8d41bd2657c0773c89128215a9268b5faa935c6cfcc94128cbff7660000000000000001000000000000000100000000000000205222f6f6e191ef047b4126d32708ea6a85699da6a9ab543355484c4be8532043000000000000000100000000000000010000000000000020d8b7b8d99a8463b16b1c1311d5d9cee8e546b25f4a03f2a29e45ce28e55ea13400000000000000010000000000000000000000000000002043898f529d46b3b4e484dcd82a7bd7de9362082425035f19ff747fb13679c0a4000000000000001100000000000000209454edf4f0fdc13210d67758ffd598f11c2b0a3595ff4c1d7da9ca33bb793287000000000000000800000000000000010000000000000000000000000000002043834b0a06d8b266b26be0854b7a79aa971fbef6ddaa80d8b15f1d8943be68c3000000000000000100000000000000010000000000000020f537a6c816605dab7bdf134249a90622b8b4bc0c39809a05575022aa320e6cd900000000000000010000000000000001000000000000002057effbdf6394e0e074df2efeed774d8c831cb1e12a71f79488d452e2f8c29c1400000000000000010000000000000001000000000000002057a730b1249f97fba51acf8c053f7e6deb146d184851b09023ca539f8fd29ea700000000000000010000000000000000000000000000002007ffab422926dd9c5664db8eca2d4f70af28f0536021588b5993707bccee3daf000000000000000100000000000000010000000000000020110a572828b30b0cd6bbd6089be622f9cfde25a3974ddc6dafab153e92d3503000000000000000010000000000000001000000000000002065b6090624c4ccffc550ffbff1c17a92472e4d70f12e988a3888c4fe8873b95300000000000000010000000000000001000000000000002048836e7b74e8f7cbe3c02016c5682b4ae2891bd5feec509cb48d7ecfc25aa3b3044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a0000000000000020a5f0e248af2e8d83373f8dbe2a263fa2fa61c70760be2cb1d672b6c528eef195000000000000000213cae950f48ebbb0040c22f7121220d51d9ae002dfb332a2525b30b2cba519eb2b3c87d79ea7a6936915db1be25bcf745f66a348733a55a7bdb2d1896ed0740f000000000000000000000000000000207be9e8276a6593be6d504ea70e98b059195254948d2d34fdf740cb205efc816600000000000000060000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d0000000000000001000000000000000100000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe40000000000000000100000000000000010000000000000020188fcbd1c886a6fe1df08203d074439a0ab7295075c39584f39a57cac59c7a4e000000000000000100000000000000010000000000000020ad83bce065c17d88d5ac7ffe06ada4516ab75113588c7f0755662895ac3db280000000000000000200000000000000110000000000000020a5f0e248af2e8d83373f8dbe2a263fa2fa61c70760be2cb1d672b6c528eef195000000000000000700000000000000010000000000000000000000000000002048e1d0e6eea4f80ba2bd07b1cd16288e1fa5d3ed2877cc0a4c87a8287b0d4cb50000000000000001000000000000000100000000000000208326e9589c61ad7bea45e4801619846e8520d95de62c029ba44c340884e7a583000000000000000100000000000000010000000000000020efb7d3b693f63614e03dbb15057ee6f06a38b0b9fac359119622a1693a09e4d50000000000000001000000000000000100000000000000202455bc821318a73283adbc358d9b93ebeed4a2c3b77e86d15732d576a86f3483000000000000000100000000000000000000000000000020e355329ef752e1191251984af003de746d7cb874a72410056ef34e561e9ae2ac000000000000000100000000000000010000000000000020b6d4f44eac1e7104c022e09c07f315b53db4ae385d1671b4d59762cf659a39ff0000000000000001000000000000000100000000000000208df11b3af5acddafd4debd2a6da157c4237557b132e705ca5f62a818c38b208a00000000000000510000000000000020a5f0e248af2e8d83373f8dbe2a263fa2fa61c70760be2cb1d672b6c528eef195000000000000000700000000000000010000000000000000000000000000002064074aaf2d18a4b6a7062d2deaeb6de0c7611a2898be13cb6eb02cf14939f415000000000000000100000000000000010000000000000020601b4d247cd9878455132cbe88dc63681d0895224581994debbeb36fdb6ecf220000000000000001000000000000000100000000000000205c4f258dd1ea8e37f008f2cc55ea6f9ea8393a7975861dc1f0099fafb85fd89a000000000000000100000000000000010000000000000020887965eb6803e90b9e2ebf06b424f0151498e7c3f32bd7bfbcd38aaffbf2157000000000000000010000000000000000000000000000002098ca15184b38ee441cebcb57343616fb16f556ab15ad9837706d34e332834b05000000000000000100000000000000010000000000000020158eed45536428a1c5b4f55c36719733ea2b479362f13570d96e7223fb751ddf000000000000000100000000000000000000000000000020c3799a6d73a98eef7793ff51af82bb5348709f82b423768dd000eace2d6a8f43044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a00000000000000207be9e8276a6593be6d504ea70e98b059195254948d2d34fdf740cb205efc81660000000000000002044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a00000000000000000000000000000020ad83bce065c17d88d5ac7ffe06ada4516ab75113588c7f0755662895ac3db28000000000000000050000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d0000000000000001000000000000000100000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe40000000000000000100000000000000010000000000000020188fcbd1c886a6fe1df08203d074439a0ab7295075c39584f39a57cac59c7a4e0000000000000002000000000000000000000000000000207be9e8276a6593be6d504ea70e98b059195254948d2d34fdf740cb205efc816600000000000000060000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d0000000000000001000000000000000100000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe40000000000000000100000000000000010000000000000020188fcbd1c886a6fe1df08203d074439a0ab7295075c39584f39a57cac59c7a4e000000000000000100000000000000010000000000000020ad83bce065c17d88d5ac7ffe06ada4516ab75113588c7f0755662895ac3db280000000000000000000000000000000207be9e8276a6593be6d504ea70e98b059195254948d2d34fdf740cb205efc816600000000000000060000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d0000000000000001000000000000000100000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe40000000000000000100000000000000010000000000000020188fcbd1c886a6fe1df08203d074439a0ab7295075c39584f39a57cac59c7a4e000000000000000100000000000000010000000000000020ad83bce065c17d88d5ac7ffe06ada4516ab75113588c7f0755662895ac3db280044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a0000000000000020ad83bce065c17d88d5ac7ffe06ada4516ab75113588c7f0755662895ac3db2800000000000000002044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a00000000000000000000000000000020188fcbd1c886a6fe1df08203d074439a0ab7295075c39584f39a57cac59c7a4e00000000000000040000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d0000000000000001000000000000000100000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe40000000000000000200000000000000000000000000000020ad83bce065c17d88d5ac7ffe06ada4516ab75113588c7f0755662895ac3db28000000000000000050000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d0000000000000001000000000000000100000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe40000000000000000100000000000000010000000000000020188fcbd1c886a6fe1df08203d074439a0ab7295075c39584f39a57cac59c7a4e00000000000000000000000000000020ad83bce065c17d88d5ac7ffe06ada4516ab75113588c7f0755662895ac3db28000000000000000050000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d0000000000000001000000000000000100000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe40000000000000000100000000000000010000000000000020188fcbd1c886a6fe1df08203d074439a0ab7295075c39584f39a57cac59c7a4e044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a0000000000000020188fcbd1c886a6fe1df08203d074439a0ab7295075c39584f39a57cac59c7a4e0000000000000002044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a000000000000000000000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe4000000000000000030000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d000000000000000200000000000000000000000000000020188fcbd1c886a6fe1df08203d074439a0ab7295075c39584f39a57cac59c7a4e00000000000000040000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d0000000000000001000000000000000100000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe4000000000000000000000000000000020188fcbd1c886a6fe1df08203d074439a0ab7295075c39584f39a57cac59c7a4e00000000000000040000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d0000000000000001000000000000000100000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe40044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a00000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe400000000000000002044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a00000000000000000000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d00000000000000020000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b7770000000000000002000000000000000000000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe4000000000000000030000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d000000000000000000000000000000202be858af7f7747713f7b5ceb6f04300954b712cf64754da0f20b5fb7f647fe4000000000000000030000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777000000000000000100000000000000010000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a0000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d0000000000000002044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a000000000000000000000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b77700000000000000010000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed000000000000000200000000000000000000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d00000000000000020000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b77700000000000000000000000000000020fddb5cf1751aceb48821fff4ef0c902206811d9e8014f95b66884ee59c91fb0d00000000000000020000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed0000000000000001000000000000000100000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b777044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a00000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b7770000000000000002044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a044f069cdb3e1f393d1ef6656ccc68690be8b6446fb7d2fddfcfac15151a201a00000000000000000000000000000020e08d2e78fe7f0000d93a5b0000000000eda00c13d58f80b4f8ffffffffffffff00000000000000000000000000000002000000000000000000000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b77700000000000000010000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed000000000000000000000000000000207b4ae9da85cf65b5edbb9d55e2896bd11e29365fc64d6a4f1575230c9fa7b77700000000000000010000000000000001000000000000000100000000000000209d878dccf8881e00d96e78dd8d5c13610cdfc56f0b6ee5e3d399689a8141c0ed";
        bytes memory init_blob = hex"00010203040506070809";
        types.transcript_data memory tr_state;
        transcript.init_transcript(tr_state, init_blob);
        types.fri_params_type memory params;
        params.modulus = modulus;
        params.r = 10;
        params.max_degree = 1023;
        uint256[] memory D_omegas = new uint256[](params.r);
        D_omegas[0] = 3161067157621608152362653341354432744960400845131437947728257924963983317266;
        D_omegas[1] = 6837567842312086091520287814181175430087169027974246751610506942214842701774;
        D_omegas[2] = 3478517300119284901893091970156912948790432420133812234316178878452092729974;
        D_omegas[3] = 10359452186428527605436343203440067497552205259388878191021578220384701716497;
        D_omegas[4] = 9088801421649573101014283686030284801466796108869023335878462724291607593530;
        D_omegas[5] = 4419234939496763621076330863786513495701855246241724391626358375488475697872;
        D_omegas[6] = 14940766826517323942636479241147756311199852622225275649687664389641784935947;
        D_omegas[7] = 19540430494807482326159819597004422086093766032135589407132600596362845576832;
        D_omegas[8] = 21888242871839275217838484774961031246007050428528088939761107053157389710902;
        D_omegas[9] = 21888242871839275222246405745257275088548364400416034343698204186575808495616;
        params.D_omegas = D_omegas;
        uint256[] memory q = new uint256[](3);
        q[0] = 0;
        q[1] = 0;
        q[2] = 1;
        params.q = q;
        uint256[] memory U = new uint256[](1);
        U[0] = 0;
        uint256[] memory V = new uint256[](1);
        V[0] = 1;
        params.U = U;
        params.V = V;
        (bool result1, uint256 proof_size1) = fri_verifier.parse_verify_proof_be(raw_proof, 0, tr_state, params);
        Assert.equal(true, result1, "Proof is not correct!");
        Assert.equal(raw_proof.length, proof_size1, "Proof length is not correct!");
        Assert.equal(raw_proof.length, fri_verifier.skip_proof_be(raw_proof, 0), "Skipping proof is not correct");
    }
}
